<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phenikaa Hotel</title>

<style>
/* ================= RESET ================= */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

body {
    background: #f4f6f9;
    color: #1a1a1a;
}

/* ================= HEADER ================= */
header {
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 100;
    background: rgba(0,0,0,0.55);
    backdrop-filter: blur(6px);
}

.header-inner {
    max-width: 1200px;
    margin: auto;
    padding: 14px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: white;
}

.logo {
    font-size: 22px;
    font-weight: 800;
    letter-spacing: 1px;
}

nav a {
    margin: 0 12px;
    color: white;
    text-decoration: none;
    font-weight: 500;
}

nav a:hover {
    text-decoration: underline;
}

.auth a {
    margin-left: 10px;
    padding: 6px 14px;
    border-radius: 4px;
    text-decoration: none;
    font-size: 14px;
}

.login {
    border: 1px solid white;
    color: white;
}

.register {
    background: white;
    color: #000;
}

/* ================= HERO SLIDER ================= */
.hero {
    position: relative;
    height: 520px;
    margin-top: 64px;
    overflow: hidden;
}

.slide {
    position: absolute;
    inset: 0;
    background-size: cover;
    background-position: center;
    opacity: 0;
    transition: opacity 1s ease;
}

.slide.active {
    opacity: 1;
}

.hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
        rgba(0,0,0,0.55),
        rgba(0,0,0,0.75)
    );
}

.hero-content {
    position: relative;
    z-index: 2;
    max-width: 1200px;
    margin: auto;
    padding: 100px 20px;
    color: white;
}

.hero-content h1 {
    font-size: 42px;
    margin-bottom: 12px;
}

.hero-content p {
    font-size: 18px;
    color: #e5e5e5;
}

/* ================= SEARCH ================= */
.search-box {
    margin-top: 30px;
    background: white;
    padding: 10px;
    border-radius: 10px;
    display: grid;
    grid-template-columns: 2fr 1.5fr 1.5fr 1.5fr auto;
    gap: 8px;
}

.search-box input,
.search-box select {
    padding: 14px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
}

.search-box button {
    background: #000;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 0 26px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
}

/* ================= CONTENT ================= */
.container {
    width: 100%;
    margin: -80px 0 60px;
    padding: 0 80px;
}

.section-title {
    font-size: 24px;
    margin: 40px 0 20px;
}

/* ================= ROOM CARDS ================= */
.cards {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 24px;
    width: 100%;
}

.room-card {
    background: #fff;
    border-radius: 18px;
    overflow: hidden;
    box-shadow: 0 12px 35px rgba(0,0,0,0.12);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.room-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 20px 50px rgba(0,0,0,0.18);
}

.room-card img {
    width: 100%;
    height: 220px;
    object-fit: cover;
}

.room-body {
    padding: 18px;
}

.room-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.room-header h3 {
    font-size: 18px;
}

.rating {
    font-size: 14px;
    font-weight: 600;
}

.room-info {
    display: flex;
    gap: 14px;
    font-size: 13px;
    color: #555;
    margin: 10px 0;
}

.room-features {
    list-style: none;
    margin: 10px 0 16px;
    font-size: 13px;
    color: #444;
}

.room-features li {
    margin-bottom: 4px;
}

.room-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.price {
    font-size: 18px;
    font-weight: 700;
}

.price span {
    font-size: 13px;
    font-weight: 400;
    color: #666;
}

.actions {
    display: flex;
    gap: 8px;
}

.btn-outline {
    padding: 8px 14px;
    border-radius: 6px;
    border: 1px solid #000;
    background: transparent;
    cursor: pointer;
}

.btn-solid {
    padding: 8px 14px;
    border-radius: 6px;
    border: none;
    background: #000;
    color: #fff;
    cursor: pointer;
}

/* ================= RESPONSIVE ================= */
@media (max-width: 900px) {
    nav {
        display: none;
    }

    .search-box {
        grid-template-columns: 1fr;
    }

    .hero-content h1 {
        font-size: 30px;
    }
}
</style>
</head>

<body>

<!-- üîê CHECK LOGIN -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const token = localStorage.getItem("token");

  if (!token) {
    alert("Vui l√≤ng ƒëƒÉng nh·∫≠p");
    location.replace("index.html");
  }
});
</script>


<header>
    <div class="header-inner">
        <div class="logo">PHENIKAA HOTEL</div>
        <nav>
  <a href="booking.html">Trang ch·ªß</a>
  <a href="booking.html">T√¨m kh√°ch s·∫°n</a>
  <a href="booking.html">ƒê·∫∑t ph√≤ng</a>
  <a href="payment.html">Thanh to√°n</a>
  <a href="history.html">L·ªãch s·ª≠</a>
</nav>

        <div class="auth" id="authArea"></div>
    </div>
</header>

<section class="hero">
    <div class="slide active" style="background-image:url('https://images.unsplash.com/photo-1542314831-068cd1dbfeeb')"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1566073771259-6a8506099945')"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1551882547-ff40c63fe5fa')"></div>
    <div class="hero-overlay"></div>

    <div class="hero-content">
        <h1>Tr·∫£i nghi·ªám ngh·ªâ d∆∞·ª°ng ƒë·∫≥ng c·∫•p</h1>
        <p>Phenikaa Hotel ‚Äì sang tr·ªçng, ti·ªán nghi, chuy√™n nghi·ªáp</p>

        <div class="search-box">
    <input id="location" placeholder="B·∫°n mu·ªën ƒë·∫øn ƒë√¢u?">
    <input type="date" id="checkIn">
    <input type="date" id="checkOut">
    <select id="capacity">
        <option value="2">2 ng∆∞·ªùi ¬∑ 1 ph√≤ng</option>
        <option value="3">3 ng∆∞·ªùi ¬∑ 1 ph√≤ng</option>
        <option value="4">4 ng∆∞·ªùi ¬∑ 1 ph√≤ng</option>
    </select>
    <button onclick="searchRooms()">T√¨m ph√≤ng</button>

</div>

    </div>
</section>

<div class="container">
    <div class="section-title">C√°c h·∫°ng ph√≤ng n·ªïi b·∫≠t</div>

    <div class="cards" id="roomList">
        <!-- Deluxe -->
        
        <!-- Standard -->
        
        <!-- Suite -->
    </div>
</div>

<script>
function searchRooms() {
    const capacity = document.getElementById("capacity").value;
    const checkIn = document.getElementById("checkIn").value;
    const checkOut = document.getElementById("checkOut").value;

    if (!checkIn || !checkOut) {
        alert("Vui l√≤ng ch·ªçn ng√†y check-in v√† check-out");
        return;
    }

    const url = `https://ominous-trout-v67rqxvv9j4v2w7rr-8083.app.github.dev/rooms/search?capacity=${capacity}&checkIn=${checkIn}&checkOut=${checkOut}`;

    fetch(url)
        .then(res => res.json())
        .then(data => {
            console.log("ROOMS:", data);
            renderRooms(data);
        })
        .catch(err => {
            console.error(err);
            alert("Kh√¥ng t√¨m ƒë∆∞·ª£c ph√≤ng");
        });
}

function renderRooms(rooms) {
    const roomList = document.getElementById("roomList");
    roomList.innerHTML = "";

    if (rooms.length === 0) {
        roomList.innerHTML = "<p>Kh√¥ng c√≥ ph√≤ng ph√π h·ª£p</p>";
        return;
    }

    rooms.forEach(room => {
        const isBooked = bookedRoomIds.includes(room.id);
        const card = document.createElement("div");
        card.className = "room-card";

        card.innerHTML = `
    <div class="room-body">
        <div class="room-header">
            <h3>${room.name}</h3>
        </div>

        <div class="room-info">
            <span>üë§ ${room.capacity} ng∆∞·ªùi</span>
        </div>

        <div class="room-footer">
            <div class="price">${room.price}ƒë <span>/ ƒë√™m</span></div>

            ${
                isBooked
                ? `<button class="btn-outline" disabled>ƒê√£ ƒë∆∞·ª£c booking</button>`
                : `<button class="btn-solid" onclick="bookRoom(${room.id})">ƒê·∫∑t ph√≤ng</button>`
            }
        </div>
    </div>
`;

        roomList.appendChild(card);
    });
}
</script>

<script>
function bookRoom(roomId) {
    const checkIn = document.getElementById("checkIn").value;
    const checkOut = document.getElementById("checkOut").value;
    const token = localStorage.getItem("token");

    if (!checkIn || !checkOut) {
        alert("Thi·∫øu ng√†y check-in ho·∫∑c check-out");
        return;
    }

    fetch("https://ominous-trout-v67rqxvv9j4v2w7rr-8082.app.github.dev/bookings", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + token
        },
        body: JSON.stringify({
            roomId: roomId,
            checkIn: checkIn,
            checkOut: checkOut,
            userEmail: localStorage.getItem("email")
        })
    })
    .then(res => {
        if (!res.ok) {
            throw new Error("Booking failed: " + res.status);
        }
        return res.json();
    })
    .then(data => {
    alert("‚úÖ ƒê·∫∑t ph√≤ng th√†nh c√¥ng\nM√£ booking: " + data.id);

    // l∆∞u m√£ booking (tu·ª≥ ch·ªçn)
    localStorage.setItem("lastBookingId", data.id);

    // chuy·ªÉn sang l·ªãch s·ª≠
    window.location.href = "history.html";
})

    .catch(err => {
        console.error(err);
        alert("‚ùå ƒê·∫∑t ph√≤ng th·∫•t b·∫°i");
    });
}
</script>

<script>
/* SLIDER */
let index = 0;
const slides = document.querySelectorAll(".slide");
setInterval(() => {
    slides[index].classList.remove("active");
    index = (index + 1) % slides.length;
    slides[index].classList.add("active");
}, 4000);

/* AUTH UI */
const email = localStorage.getItem("email");
document.getElementById("authArea").innerHTML = `
  <span style="color:white">üëã ${email}</span>
  <a href="#" class="login" onclick="logout()">ƒêƒÉng xu·∫•t</a>
`;

function logout(){
  localStorage.clear();
  location.href="index.html";
}
</script>

<script>
    let bookedRoomIds = [];
document.addEventListener("DOMContentLoaded", () => {
    loadAllRooms();
});

function loadAllRooms() {
    Promise.all([
        fetch("https://ominous-trout-v67rqxvv9j4v2w7rr-8083.app.github.dev/rooms")
            .then(res => res.json()),
        fetch("https://ominous-trout-v67rqxvv9j4v2w7rr-8082.app.github.dev/bookings/active")
            .then(res => res.json())
    ])
    .then(([rooms, bookings]) => {
        bookedRoomIds = bookings.map(b => b.roomId);
        renderRooms(rooms);
    })
    .catch(err => console.error(err));
}

</script>


<style>
.cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
}


.room-card:hover {
    transform: translateY(-4px);
}

.room-card h4 {
    margin: 0 0 10px;
}

.room-card button {
    margin-top: 12px;
    padding: 10px 16px;
    background: #000;
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}
</style>


</body>
</html>
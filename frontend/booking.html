<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phenikaa Hotel</title>

<style>
/* ================= RESET ================= */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

body {
    background: #f4f6f9;
    color: #1a1a1a;
}

/* ================= HEADER ================= */
header {
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 100;
    background: rgba(0,0,0,0.55);
    backdrop-filter: blur(6px);
}

.header-inner {
    max-width: 1200px;
    margin: auto;
    padding: 14px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: white;
}

.logo {
    font-size: 22px;
    font-weight: 800;
    letter-spacing: 1px;
}

nav a {
    margin: 0 12px;
    color: white;
    text-decoration: none;
    font-weight: 500;
}

nav a:hover {
    text-decoration: underline;
}

.auth a {
    margin-left: 10px;
    padding: 6px 14px;
    border-radius: 4px;
    text-decoration: none;
    font-size: 14px;
}

.login {
    border: 1px solid white;
    color: white;
}

.register {
    background: white;
    color: #000;
}

/* ================= HERO SLIDER ================= */
.hero {
    position: relative;
    height: 520px;
    margin-top: 64px;
    overflow: hidden;
}

.slide {
    position: absolute;
    inset: 0;
    background-size: cover;
    background-position: center;
    opacity: 0;
    transition: opacity 1s ease;
}

.slide.active {
    opacity: 1;
}

.hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
        rgba(0,0,0,0.55),
        rgba(0,0,0,0.75)
    );
}

.hero-content {
    position: relative;
    z-index: 2;
    max-width: 1200px;
    margin: auto;
    padding: 100px 20px;
    color: white;
}

.hero-content h1 {
    font-size: 42px;
    margin-bottom: 12px;
}

.hero-content p {
    font-size: 18px;
    color: #e5e5e5;
}

/* ================= SEARCH ================= */
.search-box {
    margin-top: 30px;
    background: white;
    padding: 10px;
    border-radius: 10px;
    display: grid;
    grid-template-columns: 2fr 1.5fr 1.5fr 1.5fr auto;
    gap: 8px;
}

.search-box input,
.search-box select {
    padding: 14px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
}

.search-box button {
    background: #000;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 0 26px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
}

/* ================= CONTENT ================= */
.container {
    width: 100%;
    margin: -80px 0 60px;
    padding: 0 80px;
}

.section-title {
    font-size: 24px;
    margin: 40px 0 20px;
}

/* ================= ROOM CARDS ================= */
.cards {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 24px;
    width: 100%;
}

.room-card {
    background: #fff;
    border-radius: 18px;
    overflow: hidden;
    box-shadow: 0 12px 35px rgba(0,0,0,0.12);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.room-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 20px 50px rgba(0,0,0,0.18);
}

.room-card img {
    width: 100%;
    height: 220px;
    object-fit: cover;
}

.room-body {
    padding: 18px;
}

.room-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.room-header h3 {
    font-size: 18px;
}

.rating {
    font-size: 14px;
    font-weight: 600;
}

.room-info {
    display: flex;
    gap: 14px;
    font-size: 13px;
    color: #555;
    margin: 10px 0;
}

.room-features {
    list-style: none;
    margin: 10px 0 16px;
    font-size: 13px;
    color: #444;
}

.room-features li {
    margin-bottom: 4px;
}

.room-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.price {
    font-size: 18px;
    font-weight: 700;
}

.price span {
    font-size: 13px;
    font-weight: 400;
    color: #666;
}

.actions {
    display: flex;
    gap: 8px;
}

.btn-outline {
    padding: 8px 14px;
    border-radius: 6px;
    border: 1px solid #000;
    background: transparent;
    cursor: pointer;
}

.btn-solid {
    padding: 8px 14px;
    border-radius: 6px;
    border: none;
    background: #000;
    color: #fff;
    cursor: pointer;
}

/* ================= RESPONSIVE ================= */
@media (max-width: 900px) {
    nav {
        display: none;
    }

    .search-box {
        grid-template-columns: 1fr;
    }

    .hero-content h1 {
        font-size: 30px;
    }
    
}


.modal-left {
    position: relative;
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-left img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 20px; 
}

.modal-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 40px;
    color: white;
    background: none;
    border: none;
    cursor: pointer;
}

.modal-nav.prev { left: 20px; }
.modal-nav.next { right: 20px; }

.modal-right {
    padding: 30px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

/* ===== MODAL LAYOUT ===== */
.room-modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.85);
    z-index: 9999;
    display: none;
}

.room-modal-content {
    width: 90%;
    height: 90%;
    margin: 3% auto;
    background: #fff;
    display: grid;
    grid-template-columns: 1.3fr 1fr;
    border-radius: 14px;
    overflow: hidden;
}
.modal-amenities {
    margin-top: 20px;
}

.modal-amenities h4 {
    font-size: 16px;
    margin-bottom: 10px;
    color: #111;
}

.modal-amenities ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.modal-amenities li {
    font-size: 14px;
    color: #444;
    margin-bottom: 8px;
    line-height: 1.5;
}

/* LEFT IMAGE */
.modal-left {
    position: relative;
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-left img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.modal-booking {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 1px solid #eee;
    padding-top: 20px;
}

/* N√öT QUAY V·ªÄ */
.modal-back-btn {
    background: transparent;
    border: 1px solid #ccc;
    padding: 10px 18px;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
}

/* N√öT ƒê·∫∂T PH√íNG ƒê·∫∏P H∆†N */
.modal-booking .btn-solid {
    padding: 12px 26px;
    font-size: 15px;
}



</style>
</head>

<body>
    <script>
let bookedRoomIds = [];
let currentRooms = [];
</script>


<!-- üîê CHECK LOGIN -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const token = localStorage.getItem("token");

  if (!token) {
    alert("Vui l√≤ng ƒëƒÉng nh·∫≠p");
    location.replace("index.html");
  }
});
</script>


<header>
    <div class="header-inner">
        <div class="logo">PHENIKAA HOTEL</div>
        <nav>
  <a href="booking.html">Trang ch·ªß</a>
  <a href="booking.html#search">ƒê·∫∑t ph√≤ng</a>
  <a href="payment.html">Thanh to√°n</a>
  <a href="history.html">L·ªãch s·ª≠</a>
</nav>


        <div class="auth" id="authArea"></div>
    </div>
</header>

<section class="hero">
    <div class="slide active" style="background-image:url('https://images.unsplash.com/photo-1542314831-068cd1dbfeeb')"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1566073771259-6a8506099945')"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1551882547-ff40c63fe5fa')"></div>
    <div class="hero-overlay"></div>

    <div class="hero-content">
        <h1>Tr·∫£i nghi·ªám ngh·ªâ d∆∞·ª°ng ƒë·∫≥ng c·∫•p</h1>
        <p>Phenikaa Hotel ‚Äì sang tr·ªçng, ti·ªán nghi, chuy√™n nghi·ªáp</p>

        <div class="search-box" id="search">
    <input id="location" placeholder="B·∫°n mu·ªën ƒë·∫øn ƒë√¢u?">
    <input type="date" id="checkIn">
    <input type="date" id="checkOut">
    <select id="capacity">
        <option value="2">2 ng∆∞·ªùi ¬∑ 1 ph√≤ng</option>
        <option value="3">3 ng∆∞·ªùi ¬∑ 1 ph√≤ng</option>
        <option value="4">4 ng∆∞·ªùi ¬∑ 1 ph√≤ng</option>
    </select>
    <button onclick="searchRooms()">T√¨m ph√≤ng</button>

</div>

    </div>
</section>

<div class="container">
    <div class="section-title">C√°c h·∫°ng ph√≤ng n·ªïi b·∫≠t</div>

    <div class="cards" id="roomList">
        <!-- Deluxe -->
        
        <!-- Standard -->
        
        <!-- Suite -->
    </div>
</div>

<script>
function searchRooms() {
    const capacity = document.getElementById("capacity").value;
    const checkIn = document.getElementById("checkIn").value;
    const checkOut = document.getElementById("checkOut").value;

    if (!checkIn || !checkOut) {
        alert("Vui l√≤ng ch·ªçn ng√†y check-in v√† check-out");
        return;
    }

    const url = `https://ominous-trout-v67rqxvv9j4v2w7rr-8083.app.github.dev/rooms/search?capacity=${capacity}&checkIn=${checkIn}&checkOut=${checkOut}`;

    fetch(url)
        .then(res => res.json())
        .then(data => {
            console.log("ROOMS:", data);
            renderRooms(data);
        })
        .catch(err => {
            console.error(err);
            alert("Kh√¥ng t√¨m ƒë∆∞·ª£c ph√≤ng");
        });
}

function renderRooms(rooms) {
    const roomList = document.getElementById("roomList");
    roomList.innerHTML = "";

    if (rooms.length === 0) {
        roomList.innerHTML = "<p>Kh√¥ng c√≥ ph√≤ng ph√π h·ª£p</p>";
        return;
    }

    rooms.forEach(room => {
    const isBooked = bookedRoomIds.includes(room.id);
    const images = roomImages[room.id] || [
        "https://via.placeholder.com/400x220?text=No+Image"
    ];

    const imageHtml = images.map((src, i) =>
    `<img src="${src}" class="${i === 0 ? 'active' : ''}" onclick="openRoomModal(${room.id})">`
).join("");

    const card = document.createElement("div");
    card.className = "room-card";

    card.innerHTML = `
        <div class="room-slider">
            ${imageHtml}
            <button class="prev" onclick="prevImage(this)">‚Äπ</button>
            <button class="next" onclick="nextImage(this)">‚Ä∫</button>
        </div>

        <div class="room-body">
            <div class="room-header">
                <h3>${room.name}</h3>
            </div>

            <div class="room-info">
                <span>üë§ ${room.capacity} ng∆∞·ªùi</span>
            </div>

            <div class="room-footer">
    <div class="price">${room.price}ƒë <span>/ ƒë√™m</span></div>

    <div class="actions">
        <button class="btn-outline" onclick="openRoomModal(${room.id})">
            Xem chi ti·∫øt
        </button>

        ${
            isBooked
            ? `<button class="btn-outline" disabled>ƒê√£ ƒë∆∞·ª£c booking</button>`
            : `<button class="btn-solid" onclick="bookRoom(${room.id})">ƒê·∫∑t ph√≤ng</button>`
        }
    </div>
</div>

    `;

    roomList.appendChild(card);
});

}
</script>

<script>
function bookRoom(roomId) {
    const checkIn = document.getElementById("checkIn").value;
    const checkOut = document.getElementById("checkOut").value;
    const token = localStorage.getItem("token");

    if (!checkIn || !checkOut) {
        alert("Thi·∫øu ng√†y check-in ho·∫∑c check-out");
        return;
    }

    fetch("https://ominous-trout-v67rqxvv9j4v2w7rr-8082.app.github.dev/bookings", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + token
        },
        body: JSON.stringify({
            roomId: roomId,
            checkIn: checkIn,
            checkOut: checkOut,
            userEmail: localStorage.getItem("email")
        })
    })
    .then(res => {
        if (!res.ok) {
            throw new Error("Booking failed: " + res.status);
        }
        return res.json();
    })
    .then(data => {
    alert("‚úÖ ƒê·∫∑t ph√≤ng th√†nh c√¥ng\nM√£ booking: " + data.id);

    // l∆∞u m√£ booking (tu·ª≥ ch·ªçn)
    localStorage.setItem("lastBookingId", data.id);

    // chuy·ªÉn sang l·ªãch s·ª≠
    window.location.href = "history.html";
})

    .catch(err => {
        console.error(err);
        alert("‚ùå ƒê·∫∑t ph√≤ng th·∫•t b·∫°i");
    });
}
</script>

<script>
const roomImages = {
    1: ["images/images-room-1-1.jpg", "images/images-room-1-2.jpg", "images/images-room-1-3.jpg"],
    2: ["images/images-room-2-1.jpg", "images/images-room-2-2.jpg", "images/images-room-2-3.jpg"],
    3: ["images/images-room-3-1.jpg", "images/images-room-3-2.jpg", "images/images-room-3-3.jpg"],
    4: ["images/images-room-4-1.jpg", "images/images-room-4-2.jpg", "images/images-room-4-3.jpg"],
    5: ["images/images-room-5-1.jpg", "images/images-room-5-2.jpg", "images/images-room-5-3.jpg"],
    6: ["images/images-room-6-1.jpg", "images/images-room-6-2.jpg", "images/images-room-6-3.jpg"],
    7: ["images/images-room-7-1.jpg", "images/images-room-7-2.jpg", "images/images-room-7-3.jpg"],
    8: ["images/images-room-8-1.jpg", "images/images-room-8-2.jpg", "images/images-room-8-3.jpg"],
    9: ["images/images-room-9-1.jpg", "images/images-room-9-2.jpg", "images/images-room-9-3.jpg"],
    10: ["images/images-room-10-1.jpg", "images/images-room-10-2.jpg", "images/images-room-10-3.jpg"],
    11: ["images/images-room-11-1.jpg", "images/images-room-11-2.jpg", "images/images-room-11-3.jpg"],
    12: ["images/images-room-12-1.jpg", "images/images-room-12-2.jpg", "images/images-room-12-3.jpg"],
    13: ["images/images-room-13-1.jpg", "images/images-room-13-2.jpg", "images/images-room-13-3.jpg"],
    14: ["images/images-room-14-1.jpg", "images/images-room-14-2.jpg", "images/images-room-14-3.jpg"],
    15: ["images/images-room-15-1.jpg", "images/images-room-15-2.jpg", "images/images-room-15-3.jpg"],
    16: ["images/images-room-16-1.jpg", "images/images-room-16-2.jpg", "images/images-room-16-3.jpg"],
    17: ["images/images-room-17-1.jpg", "images/images-room-17-2.jpg", "images/images-room-17-3.jpg"],
    18: ["images/images-room-18-1.jpg", "images/images-room-18-2.jpg", "images/images-room-18-3.jpg"],
    19: ["images/images-room-19-1.jpg", "images/images-room-19-2.jpg", "images/images-room-19-3.jpg"],
    20: ["images/images-room-20-1.jpg", "images/images-room-20-2.jpg", "images/images-room-20-3.jpg"]
};
</script>

<script>
let modalImages = [];
let modalIndex = 0;
let modalRoom = null;

window.openRoomModal = function (roomId) {
    modalRoom = currentRooms.find(r => r.id === roomId);
    modalImages = roomImages[roomId] || [];
    modalIndex = 0;

    document.getElementById("modalImage").src = modalImages[0];
    document.getElementById("modalRoomName").innerText = modalRoom.name;
    document.getElementById("modalRoomCapacity").innerText = "üë§ " + modalRoom.capacity + " ng∆∞·ªùi";
    document.getElementById("modalRoomPrice").innerText = modalRoom.price + "ƒë / ƒë√™m";

    const isBooked = bookedRoomIds.includes(roomId);
    document.getElementById("modalAction").innerHTML = isBooked
        ? `<button class="btn-outline" disabled>ƒê√£ ƒë∆∞·ª£c booking</button>`
        : `<button class="btn-solid" onclick="bookRoom(${roomId})">ƒê·∫∑t ph√≤ng</button>`;

    document.getElementById("roomModal").style.display = "block";
}

function closeRoomModal() {
    document.getElementById("roomModal").style.display = "none";
}

function prevModalImage() {
    modalIndex = (modalIndex - 1 + modalImages.length) % modalImages.length;
    document.getElementById("modalImage").src = modalImages[modalIndex];
}

function nextModalImage() {
    modalIndex = (modalIndex + 1) % modalImages.length;
    document.getElementById("modalImage").src = modalImages[modalIndex];
}
</script>

<script>
/* SLIDER */
let index = 0;
const slides = document.querySelectorAll(".slide");
setInterval(() => {
    slides[index].classList.remove("active");
    index = (index + 1) % slides.length;
    slides[index].classList.add("active");
}, 4000);

/* AUTH UI */
const email = localStorage.getItem("email");
document.getElementById("authArea").innerHTML = `
  <span style="color:white">üëã ${email}</span>
  <a href="#" class="login" onclick="logout()">ƒêƒÉng xu·∫•t</a>
`;

function logout(){
  localStorage.clear();
  location.href="index.html";
}
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
    loadAllRooms();
});

function loadAllRooms() {
    Promise.all([
        fetch("https://ominous-trout-v67rqxvv9j4v2w7rr-8083.app.github.dev/rooms")
            .then(res => res.json()),
        fetch("https://ominous-trout-v67rqxvv9j4v2w7rr-8082.app.github.dev/bookings/active")
            .then(res => res.json())
    ])
    .then(([rooms, bookings]) => {
        bookedRoomIds = bookings.map(b => b.roomId);
        currentRooms = rooms; 
        renderRooms(rooms);
    })
    .catch(err => console.error(err));
}

</script>


<style>
.cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
}


.room-card:hover {
    transform: translateY(-4px);
}

.room-card h4 {
    margin: 0 0 10px;
}

.room-card button {
    margin-top: 12px;
    padding: 10px 16px;
    background: #000;
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}
.room-slider {
    position: relative;
    height: 220px;
    overflow: hidden;
}

.room-slider img {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 220px;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.4s ease;
}

.room-slider img.active {
    opacity: 1;
}

.room-slider .prev,
.room-slider .next {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0,0,0,0.6);
    color: white;
    border: none;
    font-size: 22px;
    padding: 6px 10px;
    cursor: pointer;
    border-radius: 50%;
}

.room-slider .prev { left: 10px; }
.room-slider .next { right: 10px; }

</style>

<script>
function nextImage(btn) {
    const slider = btn.parentElement;
    const images = slider.querySelectorAll("img");
    let index = [...images].findIndex(img => img.classList.contains("active"));
    images[index].classList.remove("active");
    images[(index + 1) % images.length].classList.add("active");
}

function prevImage(btn) {
    const slider = btn.parentElement;
    const images = slider.querySelectorAll("img");
    let index = [...images].findIndex(img => img.classList.contains("active"));
    images[index].classList.remove("active");
    images[(index - 1 + images.length) % images.length].classList.add("active");
}
</script>

<!-- ===== ROOM FULLSCREEN MODAL ===== -->
<div id="roomModal" class="room-modal">
    <div class="room-modal-content">

        <!-- LEFT: IMAGE ONLY -->
        <div class="modal-left">
            <button class="modal-nav prev" onclick="prevModalImage()">‚Äπ</button>
            <img id="modalImage" />
            <button class="modal-nav next" onclick="nextModalImage()">‚Ä∫</button>
        </div>

        <div class="modal-right">

    <!-- T√äN PH√íNG -->
    <div class="modal-info">
        <h2 id="modalRoomName"></h2>
        <p id="modalRoomCapacity"></p>
        <p id="modalRoomPrice"></p>
    </div>

    <!-- TI·ªÜN NGHI (C√ôNG H√ÄNG, C√ôNG FONT) -->
    <div class="modal-amenities">
        <h4>Ti·ªán nghi ph√≤ng</h4>
        <ul>
            <li>üõèÔ∏è Gi∆∞·ªùng ƒë√¥i c·ª° l·ªõn, n·ªám cao c·∫•p</li>
            <li>üåÑ View ban c√¥ng</li>
            <li>‚ùÑÔ∏è ƒêi·ªÅu h√≤a hai chi·ªÅu</li>
            <li>üì∫ TV m√†n h√¨nh ph·∫≥ng</li>
            <li>üì∂ Wi-Fi mi·ªÖn ph√≠</li>
            <li>‚òï Tr√† & c√† ph√™</li>
            <li>üöø Ph√≤ng t·∫Øm ri√™ng</li>
        </ul>
    </div>

    <!-- N√öT -->
    <div class="modal-booking">
        <button class="modal-back-btn" onclick="closeRoomModal()">
            ‚Üê Quay v·ªÅ
        </button>
        <div id="modalAction"></div>
    </div>

</div>

        
</div>


</body>
</html>